---
jupyter: python3
pdf-engine: lualatex
format:
  html:
    theme : yeti
    toc: true
    code-fold: true #enable code dropdown for html output
    code-code-overflow: wrap  
    toc-title: Contents
    error: false
    warning: false
execute:
    echo: True  #True=show code in output, false=don't
---

# Exploring Data

Initial exploratory data analysis has been conducted below. The data gathered and cleaned previously have been categorized. The specific codes for data exploration can be found below in each respective section. 

## Big Five Personality Data

Prior to diving into the details of the data, it's important to understand what the Big Five Personality traits are. **Openness** relates to imagination, insight, creativity, and curiousity. **Conscientiousness** relates to thoughtfulness, self-control, attention to detail, and orderliness. **Extraversion** relates to sociability, assertiveness, and excitability. **Agreeableness** relates to prosocial behaviors, such as empathy, altruism, and affection. **Neuroticism** relates to anxiety, low stress tolerance, and emotional instability.^1^

![Verywell / Joshua Seong](big_five_comic.png)

```{python}
import  pandas  as  pd
import seaborn as sns
import matplotlib.pyplot as plt
import numpy as np 

df = pd.read_csv('../../data/01-modified-data/big_five_final.csv')

print("----------------------")
print("BASIC STATISTICS:")
print("----------------------")
print(df.describe())
```

The output above is a basic summary statistic output of the Big Five Personality data. Based on the case id count, we can see that out data set contains 212,625 individuals from the U.S. The age column also provides insight on the age of the individuals who have participated in this survey, where the youngest and oldest individuals who have taken this assessment are 10 and 99 years old, but the general age of these individuals hovers from around 18 to 29 years old. Since sex is labeled numerically in this data (where 1 = Men and 2 = Women), the mean sex of 1.6 shows that there are more women than men in this data set. Additionally, it should be noted that the scoring of each personality category is on a scale of 0 to 1, where 0 is low association and 1 is high association with a particular category.


```{python}
# ref: https://towardsdatascience.com/better-heatmaps-and-correlation-matrix-plots-in-python-41445d0f2bec

df = df[df.columns[2:]]
df.rename(columns={"agreeable_score":'agreeableness', "extraversion_score":'extraversion', "openness_score":'openness', "conscientiousness_score":'conscientiousness', "neuroticism_score":'neuroticism'}, inplace=True)
corr = df.corr()

sns.set()

def heatmap(x, y, **kwargs):
    if 'color' in kwargs:
        color = kwargs['color']
    else:
        color = [1]*len(x)

    if 'palette' in kwargs:
        palette = kwargs['palette']
        n_colors = len(palette)
    else:
        n_colors = 256 # Use 256 colors for the diverging color palette
        palette = sns.color_palette("Blues", n_colors) 

    if 'color_range' in kwargs:
        color_min, color_max = kwargs['color_range']
    else:
        color_min, color_max = min(color), max(color) # Range of values that will be mapped to the palette, i.e. min and max possible correlation

    def value_to_color(val):
        if color_min == color_max:
            return palette[-1]
        else:
            val_position = float((val - color_min)) / (color_max - color_min) # position of value in the input range, relative to the length of the input range
            val_position = min(max(val_position, 0), 1) # bound the position betwen 0 and 1
            ind = int(val_position * (n_colors - 1)) # target index in the color palette
            return palette[ind]

    if 'size' in kwargs:
        size = kwargs['size']
    else:
        size = [1]*len(x)

    if 'size_range' in kwargs:
        size_min, size_max = kwargs['size_range'][0], kwargs['size_range'][1]
    else:
        size_min, size_max = min(size), max(size)

    size_scale = kwargs.get('size_scale', 500)

    def value_to_size(val):
        if size_min == size_max:
            return 1 * size_scale
        else:
            val_position = (val - size_min) * 0.99 / (size_max - size_min) + 0.01 # position of value in the input range, relative to the length of the input range
            val_position = min(max(val_position, 0), 1) # bound the position betwen 0 and 1
            return val_position * size_scale
    if 'x_order' in kwargs: 
        x_names = [t for t in kwargs['x_order']]
    else:
        x_names = [t for t in sorted(set([v for v in x]))]
    x_to_num = {p[1]:p[0] for p in enumerate(x_names)}

    if 'y_order' in kwargs: 
        y_names = [t for t in kwargs['y_order']]
    else:
        y_names = [t for t in sorted(set([v for v in y]))]
    y_to_num = {p[1]:p[0] for p in enumerate(y_names)}

    plot_grid = plt.GridSpec(1, 15, hspace=0.2, wspace=0.1) # Setup a 1x10 grid
    ax = plt.subplot(plot_grid[:,:-1]) # Use the left 14/15ths of the grid for the main plot

    marker = kwargs.get('marker', 's')

    kwargs_pass_on = {k:v for k,v in kwargs.items() if k not in [
         'color', 'palette', 'color_range', 'size', 'size_range', 'size_scale', 'marker', 'x_order', 'y_order'
    ]}

    ax.scatter(
        x=[x_to_num[v] for v in x],
        y=[y_to_num[v] for v in y],
        marker=marker,
        s=[value_to_size(v) for v in size], 
        c=[value_to_color(v) for v in color],
        **kwargs_pass_on
    )
    ax.set_xticks([v for k,v in x_to_num.items()])
    ax.set_xticklabels([k for k in x_to_num], rotation=45, horizontalalignment='right')
    ax.set_yticks([v for k,v in y_to_num.items()])
    ax.set_yticklabels([k for k in y_to_num])

    ax.grid(False, 'major')
    ax.grid(True, 'minor')
    ax.set_xticks([t + 0.5 for t in ax.get_xticks()], minor=True)
    ax.set_yticks([t + 0.5 for t in ax.get_yticks()], minor=True)

    ax.set_xlim([-0.5, max([v for v in x_to_num.values()]) + 0.5])
    ax.set_ylim([-0.5, max([v for v in y_to_num.values()]) + 0.5])
    ax.set_facecolor('#F1F1F1')

    # Add color legend on the right side of the plot
    if color_min < color_max:
        ax = plt.subplot(plot_grid[:,-1]) # Use the rightmost column of the plot

        col_x = [0]*len(palette) # Fixed x coordinate for the bars
        bar_y=np.linspace(color_min, color_max, n_colors) # y coordinates for each of the n_colors bars

        bar_height = bar_y[1] - bar_y[0]
        ax.barh(
            y=bar_y,
            width=[5]*len(palette), # Make bars 5 units wide
            left=col_x, # Make bars start at 0
            height=bar_height,
            color=palette,
            linewidth=0
        )
        ax.set_xlim(1, 2) # Bars are going from 0 to 5, so lets crop the plot somewhere in the middle
        ax.grid(False) # Hide grid
        ax.set_facecolor('white') # Make background white
        ax.set_xticks([]) # Remove horizontal ticks
        ax.set_yticks(np.linspace(min(bar_y), max(bar_y), 3)) # Show vertical ticks for min, middle and max
        ax.yaxis.tick_right() # Show vertical ticks on the right 

def corrplot(data, size_scale=500, marker='s'):
    corr = pd.melt(data.reset_index(), id_vars='index')
    corr.columns = ['x', 'y', 'value']
    heatmap(
        corr['x'], corr['y'],
        color=corr['value'], color_range=[-1, 1],
        palette=sns.diverging_palette(20, 220, n=256),
        size=corr['value'].abs(), size_range=[0,1],
        marker=marker,
        x_order=data.columns,
        y_order=data.columns[::-1],
        size_scale=size_scale
    )

columns = ['age', 'sex', 'agreeableness', 'extraversion', 'openness', 'conscientiousness', 'neuroticism'] 

plt.figure(figsize=(10, 10))
corrplot(corr)
```

The correlation heatmap above shows the correlations among every variable pair, where the "depth" of the color and the size of eachs quare represents the magnitude of correlation. We can see that there is a weak positive correlation with age and conscientiousness. There is also a weak positive correlation with sex and agreeableness. Among the traits themselves, there is a weak positive correlation between agreeableness and conscientiousness, as well as a moderate negative correlation among neuroticism, extraversion, and conscientiousness.

```{python}
print("----------------------")
print("CORRELATION MATRIX:")
print("----------------------")
print(corr)
```

We can also numerically represent the previous correlation heatmap and see the raw correlation numbers.

## Twitter Data
```{python}
df = pd.read_csv('../../data/01-modified-data/Tweets_final.csv')

# turn DF to a single string of words based on their counts
hashtags = np.array(np.repeat(df['Word'], df['Count']))
hashtags_comb = " ".join(hashtags)

def generate_word_cloud(my_text):
    from wordcloud import WordCloud, STOPWORDS
    import matplotlib.pyplot as plt
    # exit()
    # Import package
    # Define a function to plot word cloud
    def plot_cloud(wordcloud):
        # Set figure size
        plt.figure(figsize=(40, 30))
        # Display image
        plt.imshow(wordcloud)
        # No axis details
        plt.axis("off")
    # Generate word cloud
    wordcloud = WordCloud(
        width = 3000,
        height = 2000,
        random_state=1,
        background_color='salmon',
        colormap='Pastel1',
        collocations=False,
        stopwords = STOPWORDS).generate(my_text)
    plot_cloud(wordcloud)
    plt.show()

generate_word_cloud(hashtags_comb)
```

Based on the Twitter API call for multiple keywords associated with both the women's and men's rights movements, we generated the wordcloud shown above. Other than "worldwide," we can see that "mensrights" and "womenvsmen" are most noticeable. Interestingly, despite searching for tweets with 3 terms relating to women's rights and 3 terms relating to men's rights, it's clear that there are more hashtag relating to women's rights (e.g. "womensrightsarehumanrights", "womensrights", "womentalking"), issues (e.g. "votingrights", "saveroevswade", "votebluetoprotectwomen"), and involvements (e.g. "womenintech", "womeninscience", "womeninresearch").

## Wikipedia Data
```{python}
#RELOAD FILE AND PRETEND THAT IS OUR STARTING POINT 
df=pd.read_csv('../../data/00-raw-data/wiki-crawl-results.csv')  
print(df.shape)

#CONVERT FROM STRING LABELS TO INTEGERS 
labels=[]; #y1=[]; y2=[]
y1=[]
for label in df["label"]:
    if label not in labels:
        labels.append(label)
        print("index =",len(labels)-1,": label =",label)
    for i in range(0,len(labels)):
        if(label==labels[i]):
            y1.append(i)
y1=np.array(y1)

# CONVERT DF TO LIST OF STRINGS 
corpus=df["text"].to_list()
y2=df["sentiment"].to_numpy()

df = df.rename(columns={'label': 'Search Terms', 'sentiment': 'Sentiment Score'})
sentiment_f = df[df['Search Terms'] == "Women's rights"]['Sentiment Score']
sentiment_m = df[df['Search Terms'] == "Men's rights"]['Sentiment Score']

ax = sns.displot(df, x="Sentiment Score", hue='Search Terms', kind="kde", palette=['red', 'blue'])
ax.fig.suptitle('Sentiment score density plots of Wikicrawl', x=0.4, y = 1.05, fontsize=15)
```

Based on the Wikicrawl, we created density plots based on the sentiment scores of the vectorized sentences. We can see that the resulting distributions for the search terms "Women's rights" and "Men's rights" are both bimodal around -0.75 and 1.0. It's also worth mentioning that the sentiment scores for "Women's rights" appears to be more polarized, as there is a large peak for negative sentiment at -0.75, then a large dip towards neutral sentiment at 0.0, and then another large peak at positive sentiment at 1.0. However, the sentiment scores for "Men's rights" appears to be a bit more consistent throughout when compared to the sentiment of "Women's rights", not varying too much across negative, neutral, and positive sentiment. This may suggest that "Women's rights" may be a more polarizing topic than "Men's rights."

## NCES Data
```{r}
library(tidyverse)
library(ggplot2)
library(scales)

df <- read.csv('../../data/01-modified-data/degrees_(by_sex_and_by_field)_final.csv')
df <- df %>% group_by(Measure, sex) %>% summarize(count=sum(Value)) %>% filter(sex=='M' | sex=='F')
level_order <- c("Bachelor's", "Master's", "Doctor's")
ggplot(df, aes(fill=sex, x=factor(Measure, level=level_order), y=count)) + 
        geom_bar(position='fill', stat='identity') + 
        scale_y_continuous(expand = c(0,0)) +
        ggtitle("Frequency of Degrees by sex (2018-2019)") +
        xlab('Degree') + 
        ylab('Frequency') + 
        theme_classic()
```

Observing the Bachelor's, Master's, and Doctor's degrees earned in 2018-2019, the bar graph above shows once again that women pursuit higher education at a greater frequency than men.

```{r}
df <- read.csv('../../data/01-modified-data/counts_(by_sex_and_by_field)_final.csv')
level_order <- c("Transportation and materials moving", "Engineering technologies", 
                 "Military technologies and applied sciences",  
                 "Computer and information sciences and support services", 
                 "Engineering", "Philosophy and religious studies", 
                 "Theology and religious vocations", "History", "Mathematics and statistics", 
                 "Physical sciences and science technologies",  "Communications technologies", 
                 "Business", "Architecture and related services", 
                 "Parks, recreation, leisure, fitness, and kinesiology", 
                 "Homeland security, law enforcement, and firefighting",
                 "Social sciences and history", "Social sciences", 
                 "Agriculture and natural resources", "Precision production", 
                 "Visual and performing arts", "Communication, journalism, and related programs", 
                 "Biological and biomedical sciences", 
                 "Liberal arts and sciences, general studies, and humanities", 
                 "Multi/interdisciplinary studies", "Foreign languages, literatures, and linguistics", 
                 "Legal professions and studies", "English language and literature/letters", 
                 "Area, ethnic, cultural, gender, and group studies", "Psychology", 
                 "Education", "Public administration and social services", 
                 "Health professions and related programs", "Family and consumer sciences/human sciences", 
                 "Library science", "All fields, total")
ggplot(df, aes(fill=sex, x=factor(Occupations, level=level_order), y=Value)) + 
        geom_bar(position='fill', stat='identity') + 
        scale_y_continuous(expand = c(0,0)) +
        coord_flip() +
        ggtitle("Frequency of Bachelor's degrees in specific fields of study by sex (2019-2020)") +
        xlab('Fields of Study') + 
        ylab('Frequency') + 
        theme_classic()
```

The figure above shows the distribution of Bachelor's degrees given to men and women across various fields of study in 2019-2020 with the fields of study arranged in descending order according to female representation (except the top most bar, which is the total representation across all fields). We can see from the bar graph that there is a noticeable contrast in the fields of study men and women pursuit. For example, women seem to make up the majority in the social sciences, liberal arts, and humanities (except for fields such as Biology), while men seem to make up the majority in STEM and manual labor fields (except for fields such as Theology and Philosophy).

## BLS Data
```{r}
df <- read.csv('../../data/01-modified-data/earnings_and_unemployment_rates_(by_educational_attainment)_final.csv')
ggplot(df[1:8,], aes(x=reorder(Educational.attainment, Value), y=Value)) + 
        geom_bar(stat='identity', position=position_dodge(), alpha=0.75, fill='darkgreen') + 
        scale_y_continuous(expand = c(0,0)) +
        coord_flip() +
        geom_text(aes(label=Value), fontface="bold", vjust=0.5, hjust=1.5, color="white", size=4) +
        ggtitle("Median weekly earnings (USD) for people above age 25 by level of education (2021)") +
        xlab('Level of Education') + 
        ylab('Median Weekly Earning (USD)') + 
        theme_classic()
```

Observing bar graph above, we can see that for people above 25 years old in 2021 the median weekly earnings (USD) increased at their level of educational attainment increased.

```{r}
ggplot(df[9:16,], aes(x=reorder(Educational.attainment, -Value), y=Value)) + 
        geom_bar(stat='identity', position=position_dodge(), alpha=0.75, fill='red') + 
        scale_y_continuous(expand = c(0,0)) +
        coord_flip() +
        geom_text(aes(label=Value), fontface="bold", vjust=0.5, hjust=1.5, color="white", size=4) +
        ggtitle("Unemployment rate (%) for people above age 25 by level of education (2021)") +
        xlab('Level of Education') + 
        ylab('Unemployment Rate (%)') + 
        theme_classic()
```

The inverse observation can be seen with the unemployment rate, which shows a lower unemployment rate for those achieving higher levels of education.

```{r}
df <- read.csv('../../data/01-modified-data/employment_(by_occupation_and_by_sex)_final.csv')
df <- df %>% filter(sex=='M' | sex=='F')
dfm <- df[df$sex=='M',]
dff <- df[df$sex=='F',]
level_order <- c("Healthcare support occupations" ,
                 "Personal care and service occupations", "Healthcare practitioners and technical occupations", 
                 "Education, training, and library occupations", "Office and administrative support occupations", 
                 "Community and social service occupations", "Production occupations", "Computer and mathematical occupations", 
                 "Production, transportation, and material moving occupations", "Farming, fishing, and forestry occupations", 
                 "Protective service occupations", "Transportation and material moving occupations", 
                 "Architecture and engineering occupations", "Natural resources, construction, and maintenance occupations", 
                 "Construction and extraction occupations", "Installation, maintenance, and repair occupations")
ggplot(df[abs(dfm$Value - dff$Value) > 33,], aes(fill=sex, x=factor(Occupation, level=level_order), y=Value)) +
        geom_bar(position='fill', stat='identity') +
        scale_y_continuous(expand = c(0,0)) +
        coord_flip() +
        ggtitle("Most polarized occupations for people above age 16 by sex (2021)") +
        xlab('Occupation') + 
        ylab('Frequency') + 
        theme_classic()
```

Additionally, the frequency plot above shows the most polarized (i.e. one sex having double or more employment in) occupations for people above 16 years old in 2021. Based on the listed occupations, we can see that fields dominated by men tend to be physical / manual labor or dealing with objects, while fields dominated by women tend to relate to service and interacting with people.

```{r}
df <- read.csv('../../data/01-modified-data/employmentRates_final.csv')
ggplot(df, aes(x=date, y=Value, group=sex, color=sex)) +
        geom_line() +
        ggtitle("Employment Rates for various age groups in the U.S. (1948-2022)") +
        xlab('Date') + 
        ylab('Employment Rate (%)') + 
        scale_color_manual(values=c('darkgreen', 'red', 'blue')) +
        theme_classic() +
        theme(axis.ticks.x=element_blank(),
              axis.text.x=element_blank()) +
        facet_wrap(~Measure)
```

The line graph above shows employment rates for men and women across various age groups in the U.S. from 1948 to 2022. From this figure, we can see that over the span of nearly eight decades, the employment rate of men has been slowly declining while women's employment rate has been drastically rising. However, other than the 16-24 age bracket, there still is quite noticeable disparities in male and female employment.

```{r}
df <- read.csv('../../data/01-modified-data/hours_worked_(by_sex_and_by_occupation)_final.csv')
df1 <- df[df$Measure=="No. people at work" | df$Measure=='No. people who worked < 35hrs' | df$Measure=='No. people who worked 35+ hrs',] %>%
        filter(!row_number() %in% c(1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85)) %>% 
        mutate(Value = Value / 1000)
df2 <- df[df$Measure=="Average hrs worked among all workers" | df$Measure=='Average hrs worked among full-time workers',] %>%
        filter(!row_number() %in% c(1, 7, 13, 19, 25, 31, 37, 43, 49, 55, 61, 67, 73, 79, 85))
ggplot(df1[df1$sex=='M' | df1$sex=='F',], aes(fill=sex, x=Category, y=Value)) + 
        geom_bar(position='dodge', stat='identity') + 
        scale_y_continuous(expand = c(0,0)) +
        coord_flip() +
        ggtitle("Number of workers (in thousands) in various fields by sex (2021)") +
        xlab('Fields') + 
        ylab('Number of workers (in thousands)') + 
        theme_classic() +
        facet_wrap(~Measure)
```

The bar graph shows the number of workers (in thousands) in various fields by sex in 2021. This is further categorized based on those who work <35 hours and those who work 35+ hours. When observing just the number of people at work, we can once again see that women tend to dominate fields that engage with people, while men tend to dominate fields that involve manual labor and handling objects. This trend is consistent even across those working <35 hours and those who work 35+ hours, with the only exception being Management/Professional occupations.

```{r}
ggplot(df2[df2$sex=='M' | df2$sex=='F',], aes(fill=sex, x=Category, y=Value)) + 
        geom_bar(position='dodge', stat='identity') + 
        scale_y_continuous(expand = c(0,0)) +
        coord_flip() +
        ggtitle("Hours worked in various fields by sex (2021)") +
        xlab('Fields') + 
        ylab('Hours worked') + 
        theme_classic() +
        facet_wrap(~Measure)
df2[df2$sex=='M',]$Value - df2[df2$sex=='F',]$Value
```

The bar graph above shows the number of hours worked in various fields by sex in 2021 and is further specified to only full-time workers. In both cases, men tend to work anywhere from 0.8 to 4.1 more hours than women.

```{r}
df <- read.csv('../../data/01-modified-data/wages_(by_occupation_may_2021)_final.csv')
ggplot(df[df$Measure=='Mean Annual Wage',], aes(fill=Occupation, x=Occupation, y=Value)) + 
        geom_bar(position='dodge', stat='identity') + 
        scale_y_continuous(expand = c(0,0)) +
        coord_flip() +
        ggtitle("Mean annual wage (USD) in various fields (May 2021)") +
        xlab('Fields') + 
        ylab('Mean Annual Wage (USD)') + 
        theme_classic() +
        theme(legend.position="none")
df[df$Measure=='Mean Annual Wage',] %>% arrange(desc(Value))
```

The bar graph above shows the mean annual wage (USD) in various fields in May 2021. From this graph, we can see that the top three highest paying jobs as of May 2021 were:

1) Management
2) Legal
3) Computer and Mathematical

Similarly, the three lowest paying jobs were:
1) Food Preparation and Serving Related
2) Healthcare Support
3) Personal Care and Service

Upon closer inspection, we can see that STEM and business-related made up higher paying jobs, while the lower paying end consisted of service and manual labor jobs.

## CAWP Data
```{r}
df <- read.csv('../../data/01-modified-data/percent_us_women_in_gov_final.csv')
ggplot(df, aes(x=Year, y=Value)) +
        geom_line() +
        ggtitle("Female representation (%) in the U.S. government (1965-2021)") +
        xlab('Year') + 
        ylab('Female Representation (%)') + 
        theme_classic() +
        facet_wrap(~Measure)
df[df$Year=='2021',]
```

The line graphs show various forms of female representation in the U.S. government from 1965 to 2021. We can see from the graphs that female representation in the U.S. government has been steadily increasing over the past six decades, but it should also be noted that women only make up 18% of state governors, 27.3% of U.S. representatives, 26% of senators, and 30.8% of state legislators.

## CB Data
```{r}
df <- read.csv('../../data/01-modified-data/Percentage-of-the-us-population-with-a-college-degree-by-gender-1940-2021.csv')
ggplot(df, aes(x=Year, y=Value, group=Measure, color=Measure)) +
        geom_line(size=1.5) +
        ggtitle("Percentage of college degree holders in the U.S. by sex (1940-2021)") +
        xlab('Date') + 
        ylab('Percentage of college degree holders (%)') + 
        scale_color_manual(values=c('blue', 'red')) +
        theme_classic()
df[df$Value[df$Measure=='Men with a college degree in the U.S. (%)'] < df$Value[df$Measure=='Women with a college degree in the U.S. (%)'],]
```

The line graph above shows the percentage of college degrees holders in the U.S. within their sex from 1940 to 2021. We can see from the graph that from 1940 to around 2010 there was a greater proportion of college degree holders among men than among women. However, after 2014, we can see the inflection point in which women have now become a greater proportion of women have attained college degrees than men.

The following line graphs show varying ranges of education people (in thousands) have completed in the U.S. based on sex and age groups (25-34, 35-54, 55+) from 1940 to 2021.

```{r}
df <- read.csv('../../data/01-modified-data/School_Completion_(by_Age_and_Sex)_from_1940_to_2021_final.csv')
df$Value <- df$Value / 1000
ggplot(filter(df, grepl("0-4 years of education", Measure)), aes(x=Year, y=Value, group=sex, color=sex)) +
        geom_line() +
        ggtitle("Number of people (in thousands) by sex and by age group who have completed 0-4 years of education (1940-2021)") +
        xlab('Year') + 
        ylab('Number of people (in thousands)') + 
        scale_color_manual(values=c('red', 'blue')) +
        theme_classic() +
        facet_wrap(~Measure)
```

Among 25-35 and 35-54 year olds, there has been a relatively consistent downwards trend in the number of people obtaining 0-4 years of education. Among 55+ year olds, there was an increase in the number of people obtaining 0-4 years of education, peaking around 1970 but sees a downwards trend thereafter.

```{r}
ggplot(filter(df, grepl("5-8 years of education", Measure)), aes(x=Year, y=Value, group=sex, color=sex)) +
        geom_line() +
        ggtitle("Number of people (in thousands) by sex and by age group who have completed 5-8 years of education (1940-2021)") +
        xlab('Year') + 
        ylab('Number of people (in thousands)') + 
        scale_color_manual(values=c('red', 'blue')) +
        theme_classic() +
        facet_wrap(~Measure)
```

Among 25-35 and 35-54 year olds, there has been a relatively consistent downwards trend in the number of people obtaining 5-8 years of education. Among 55+ year olds, there was an increase in the number of people obtaining 0-4 years of education, peaking around 1960 for men and 1980 for women but sees a downwards trend thereafter.

```{r}
ggplot(filter(df, grepl("9-11 years of education", Measure)), aes(x=Year, y=Value, group=sex, color=sex)) +
        geom_line() +
        ggtitle("Number of people (in thousands) by sex and by age group who have completed 9-11 years of education (1940-2021)") +
        xlab('Year') + 
        ylab('Number of people (in thousands)') + 
        scale_color_manual(values=c('red', 'blue')) +
        theme_classic() +
        facet_wrap(~Measure)
```

Among 25-35 year olds, there has been a relatively consistent downwards trend in the number of women obtaining 9-11 years of education, while men saw a peak around 1990 before returning on a downwards trajectory. Among 35-54 year olds, both men and women obtaining 9-11 years of education increased, peaking around 1960 before returning to a downwards trend; however, the number of men obtaining 9-11 years of education saw an increase from around 1990 to 2010 before declining again. Among 55+ year olds, there was an increase in the number of people obtaining 9-11 years of education, peaking around 1990 and declining thereafter.

```{r}
ggplot(filter(df, grepl("12 years of education", Measure)), aes(x=Year, y=Value, group=sex, color=sex)) +
        geom_line() +
        ggtitle("Number of people (in thousands) by sex and by age group who have completed 12 years of education (1940-2021)") +
        xlab('Year') + 
        ylab('Number of people (in thousands)') + 
        scale_color_manual(values=c('red', 'blue')) +
        theme_classic() +
        facet_wrap(~Measure)
```

Among all age groups, the number of people obtaining 12 years of education has seen a relatively consistent increasing trend. However, among 25-34 year olds, there was a dip from around 1990 to 2005 for men and from around 1990 to 2015 for women before returning upwards; similarly, among 35-54 year olds, there was a dip from around 2010 for men and 2005 for women.

```{r}
ggplot(filter(df, grepl("13-15 years of education", Measure)), aes(x=Year, y=Value, group=sex, color=sex)) +
        geom_line() +
        ggtitle("Number of people (in thousands) by sex and by age group who have completed 13-15 years of education (1940-2021)") +
        xlab('Year') + 
        ylab('Number of people (in thousands)') + 
        scale_color_manual(values=c('red', 'blue')) +
        theme_classic() +
        facet_wrap(~Measure)
```

Among all age groups, the number of people obtaining 13-15 years of education has seen a relatively consistent increasing trend. However, among 35-54 year olds, there was a dip from around 2005 for both men and women.

```{r}
ggplot(filter(df, grepl("16", Measure)), aes(x=Year, y=Value, group=sex, color=sex)) +
        geom_line() +
        ggtitle("Number of people (in thousands) by sex and by age group who have completed 16+ years of education (1940-2021)") +
        xlab('Year') + 
        ylab('Number of people (in thousands)') + 
        scale_color_manual(values=c('red', 'blue')) +
        theme_classic() +
        facet_wrap(~Measure)
```

Among all age groups, the number of people obtaining 16+ years of education has seen a relatively consistent increasing trend.
